# Pico-CTF 2014: Javascrypt

**Category:** Web Exploitation
**Points:** 40
**Total Solves:** Not Available
## Problem Description:

[//]: # (> This program is vulnerable to a format string attack! See if you can modify a variable by supplying a format string! The binary can be found at /home/format/ on the shell server. The source can be found [here](format.c\).)
> Tyrin Robotics Lab uses a [special web site](https://picoctf.com/api/autogen/serve/index.html?static=false&pid=b1d725db54a1fb027ea6bbd78f9a7d0b) to encode their secret messages. Can you determine the value of the secret key?

## Write-up
[//]: # (> Your write up goes here.)
> Once we goto the page we see a input box, where one can provide input, and button name Encode which will encode the content in input box. To see what page is doing, right click and do inspect on webpage in any browser. 
Our first guess is webpage might be encoding the content with javascript as the name of the problem suggests. 
So, after looking at the script our guess is confirmed. What this webpage does is on load it generates a key and store it in a global variable key. 
``` html
<script language="javascript">
            var key; // Global variable.             
            // Since the key is generated when the page 
            // is loaded, no one will be able to steal it
            // by looking at the source! This must be secure!
            function generateKey() {
                var i = 1;
                var x = 202;
                var n = 5493;
                while (i <= 25) {
                    x = (x * i) % n;
                    i++;
                }
                key = "flag_" + Math.abs(x);
            }            
            generateKey();            
            // Encode the message using the 'key'
            function encode() {                                                        
                var input = $("#inputmessage").val();
                var output = CryptoJS.AES.encrypt(input, key);
                $("#outputmessage").val(output);
            }
		</script>
```
To see it's content we can go to console tab inside inspect window, in order to print the content of variable key, we can use command: `window.alert(key)` and browser prints the key variable in alert window.

> Flag is : `flag_4719`.

## Other write-ups and resources

* None
