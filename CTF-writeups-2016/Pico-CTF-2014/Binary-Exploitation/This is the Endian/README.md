# Pico-CTF 2014: This is the Endian

**Category:** Binary Exploitation
**Points:** 40
**Total Solves:** Not Available
## Problem Description:
[//]: # (Description of your problem. For eg use below description as a template)
[//]: # (> This program is vulnerable to a format string attack! See if you can modify a variable by supplying a format string! The binary can be found at /home/format/ on the shell server. The source can be found [here](format.c\).)
> This is the end! Solving this challenge will help you defeat Daedalus's cyborg. You can find more information about endianness and the problem [here](https://picoctf.com/problem-static/binary/this-is-the-endian/endian.html#1). The flag is the smallest possible program input that causes the program to print "Access Granted".

## Write-up
[//]: # (> Your write up goes here.)

> In this problem we are given c binary which reads char input from stdin and convert them to 2 int of size of 4 by typecasting. After converting them into 2 ints it compare it agains 2 integer whose hex value is hardcoded in source code. 
```C
int main(int argc, char **argv) {
    size_t answer_size = sizeof(int32_t)*2+2;
    char* str_answer = calloc(1, answer_size);
    printf("Access Code: ");
    fgets(str_answer, answer_size, stdin);
    trim(str_answer);
    int32_t* answer = (int32_t*)str_answer;
    if(answer[0] == 0x52657663 && answer[1] == 0x30646521) {
        printf("Access Granted!\n");
    } else {
        printf("You supplied: 0x%x and 0x%x\n", answer[0], answer[1]);
    }
    free(str_answer);
    return 0;
}
```

As we can see from the source code hex value of first int is `0x52657663` and for second value is `0x30646521`. To succesfully print the "Access Granted" we need to give input such characters when it get typecasted to int of size 4 bytes it gets converted to previously mentioned hex values. We can give as much big input we want, but flag is smallest possible input so that is going to be of 8 chars.

> We want two integer of size of 4, so we need to input 8 chars out of which 4 chars will be used for first int and 4 for second as size of char is 1 byte. To charcters out the hex values 0x52657663 and 0x30646521 we can use xxd. 
Command get chars for these hex values: `echo "0x52657663" | xxd -r` 
Chars for `0x52657663` : "Revc"
chars for `0x30646521` : "0de!"

> Once we get the chars of input, now we get to the real problem of Little endian and Big endian. So, First we need to check the endianness of machine on which we are going to run the binary with command `lscpu` and it shows that its Little Endian. Once we figured out endiannes we just need to reverese the input chars for each integer. Flag is `cveR!ed0`

## Other write-ups and resources

* None
